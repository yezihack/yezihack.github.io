---
title: "云运维笔记(1) CentOS7 安装"
date: 2022-08-03T16:54:31+08:00
lastmod: 2022-08-03T16:54:31+08:00
draft: false
tags: ["linux", "教程", "云运维笔记"]
categories: ["云运维笔记"]
author: "百里"
comment: false
toc: true
reward: true
# 音乐开关，true/false
music: false
# 只支持163的音乐，在生成外链播放器获取ID
music_id: "22748787"
# 是否自动播放 1是，0否
music_auto: 1
# weight: 1
# description: ""
---
<!-- TOC -->

- [.1. 准备 CentOS7 镜像](#1-准备-centos7-镜像)
- [.2. Vmware Workstation 安装 CentOS7](#2-vmware-workstation-安装-centos7)
- [.3. 配置虚拟机网络](#3-配置虚拟机网络)
- [.4. 配置 CentOS 网络](#4-配置-centos-网络)
- [.5. 更改 CentOS7 Yum源](#5-更改-centos7-yum源)
- [.6. 安装常用的软件](#6-安装常用的软件)
- [.7. 安装 Oh-my-zsh](#7-安装-oh-my-zsh)
- [.8. 克隆系统](#8-克隆系统)
- [.9. 关于作者](#9-关于作者)

<!-- /TOC -->

## .1. 准备 CentOS7 镜像

使用清华大学开源镜像站下载 CentOS7: <https://mirrors.tuna.tsinghua.edu.cn/centos/7/isos/x86_64/>

![centos-install-20220803171053](https://cdn.jsdelivr.net/gh/yezihack/assets/b/centos-install-20220803171053)

- [CentOS-7-x86_64-DVD-2009.iso](https://mirrors.tuna.tsinghua.edu.cn/centos/7/isos/x86_64/CentOS-7-x86_64-DVD-2009.iso) 标准安装版
- [CentOS-7-x86_64-Everything-2009.iso](https://mirrors.tuna.tsinghua.edu.cn/centos/7/isos/x86_64/CentOS-7-x86_64-Everything-2009.iso) 完整版，集成所有软件
- [CentOS-7-x86_64-Minimal-2009.iso](https://mirrors.tuna.tsinghua.edu.cn/centos/7/isos/x86_64/CentOS-7-x86_64-Minimal-2009.iso) 精简版，自带的软件最少
- [CentOS-7-x86_64-NetInstall-2009.iso](https://mirrors.tuna.tsinghua.edu.cn/centos/7/isos/x86_64/CentOS-7-x86_64-NetInstall-2009.iso)  网络安装版（从网络安装或者救援系统)

本次安装教程使用[精简版](https://mirrors.tuna.tsinghua.edu.cn/centos/7/isos/x86_64/CentOS-7-x86_64-Minimal-2009.iso)镜像。因为无须图形界面，也无须自带太多的软件。

## .2. Vmware Workstation 安装 CentOS7

操作相对比较简单，下一步即可。

- 新建虚拟机
- 选择镜像源
- 下一步
- 调整配置
  - 内存调整为 2GB。
  - CPU调整为 2 个处理器，每个处理器内核数量为 2。
- 开启此虚拟机

![centos-install-20220803171630](https://cdn.jsdelivr.net/gh/yezihack/assets/b/centos-install-20220803171630)

## .3. 配置虚拟机网络

- 网络规划：192.168.9.0/24
- 虚拟机采用 NAT 模式连接宿主机网络

菜单 -> 编辑 -> 虚拟网络编辑器：

- 选择：VMnet8
- 使用 NAT 模式
- 子网IP： 192.168.9.0
- 子网掩码：255.255.255.0

![centos-install-20220803174033](https://cdn.jsdelivr.net/gh/yezihack/assets/b/centos-install-20220803174033)

NAT 设置：

- 网关IP：192.168.9.2

![centos-install-20220803174148](https://cdn.jsdelivr.net/gh/yezihack/assets/b/centos-install-20220803174148)

最后应用设置 -> 确认 -> 完成设置。

## .4. 配置 CentOS 网络

采用固定 IP 模式设置。

- BOOTPROTO 由原来的"dhcp"改为"static"
- ONBOOT="yes" 开机启动
- IPADDR="192.168.9.10" 设置本机IP地址
- GATEWAY="192.168.9.2" 设置网关IP，即上一步设置的网关IP
- NETMASK="255.255.255.0" 设置子网掩码，即上一步设置的子网掩码

所有配置如下：

```sh
$ cat /etc/sysconfig/network-scripts/ifcfg-ens33 
TYPE="Ethernet"
PROXY_METHOD="none"
BROWSER_ONLY="no"
BOOTPROTO="static"
DEFROUTE="yes"
IPV4_FAILURE_FATAL="no"
IPV6INIT="yes"
IPV6_AUTOCONF="yes"
IPV6_DEFROUTE="yes"
IPV6_FAILURE_FATAL="no"
IPV6_ADDR_GEN_MODE="stable-privacy"
NAME="ens33"
UUID="7ce873a8-d5f8-471a-8c7a-***********"
DEVICE="ens33"
ONBOOT="yes"
IPADDR="192.168.9.10"
GATEWAY="192.168.9.2"
NETMASK="255.255.255.0"

$ cat /etc/resolv.conf 
# Generated by NetworkManager
nameserver 223.5.5.5
```

最后重启网络：`systemctl restart network`

测试网络：`ping www.bing.com`

使用 XSHELL 连接更加方便操作。

## .5. 更改 CentOS7 Yum源

更改为国内 YUM 源，安装一些必要软件并更新系统软件。

- 采用阿里镜像源

```sh
# 安装 wget 
sudo yum -y install wget
# 备份源
mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
# 使用 CentOS7 的源
wget -O /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo
# 安装一个 epel-release 的软件包
yum -y install epel-release
# 清理&生成缓存
yum clean all && yum makecache
# 更新
yum -y update
```

## .6. 安装常用的软件

```sh
yum -y install net-tools git vim telnet screen tree nmap dos2unix lrzsz nc lsof wget tcpdump htop iftop iotop sysstat nethogs ipvsadm chrony  ipvsadm bridge-utils
```

## .7. 安装 Oh-my-zsh

```sh
curl -sSL https://gitee.com/sgfoot/library/raw/master/oh-my-zsh/install.sh |bash
```

将 zsh 设置默认 shell

```sh
chsh -s /bin/zsh
```

## .8. 克隆系统

后续安装 Kubernetes，需要多台虚拟机，所以我们可以克隆系统，达到一劳永逸的效果。

- 右击虚拟机 -> 管理 -> 克隆

![centos-install-20220804103004](https://cdn.jsdelivr.net/gh/yezihack/assets/b/centos-install-20220804103004)

## .9. 关于作者

我的博客：<https://yezihack.github.io>

欢迎关注我的微信公众号【空树之空】，共同学习，一起进步~
![空树之空](https://cdn.jsdelivr.net/gh/yezihack/assets/b/20210122112114.png?imageslim)
