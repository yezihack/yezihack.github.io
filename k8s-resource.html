<!doctype html><html lang=zh-cn itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>第三章 Kubernetes 资源管理 - 空樹之空的博客</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=MobileOptimized content="width"><meta name=HandheldFriendly content="true"><meta name=applicable-device content="pc,mobile"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=mobile-web-app-capable content="yes"><meta name=author content="百里"><meta name=description content="本章节主要介绍yaml语法和kubernetes的资源管理方式 资源管理介绍 在kubernetes中，所有的内容都抽象为资源，用户需要通过操作"><meta name=keywords content="Go语言,MySQL,Redis,设计模式,读书笔记,人生感悟"><meta name=generator content="Hugo 0.79.1"><link rel=canonical href=/k8s-resource.html><link rel=icon href=/favicon.ico><link rel=stylesheet href=/sass/jane.min.021cece56b7a73d45503de6c44a7f04dc9247fa4d50d932d81c81d1f76ef1efe.css integrity="sha256-Ahzs5Wt6c9RVA95sRKfwTckkf6TVDZMtgcgdH3bvHv4=" media=screen crossorigin=anonymous><link rel=stylesheet href=/css/toc.css><meta property="og:title" content="第三章 Kubernetes 资源管理"><meta property="og:description" content="本章节主要介绍yaml语法和kubernetes的资源管理方式 资源管理介绍 在kubernetes中，所有的内容都抽象为资源，用户需要通过操作"><meta property="og:type" content="article"><meta property="og:url" content="/k8s-resource.html"><meta property="article:published_time" content="2021-10-28T16:19:54+08:00"><meta property="article:modified_time" content="2021-10-28T16:19:54+08:00"><meta itemprop=name content="第三章 Kubernetes 资源管理"><meta itemprop=description content="本章节主要介绍yaml语法和kubernetes的资源管理方式 资源管理介绍 在kubernetes中，所有的内容都抽象为资源，用户需要通过操作"><meta itemprop=datePublished content="2021-10-28T16:19:54+08:00"><meta itemprop=dateModified content="2021-10-28T16:19:54+08:00"><meta itemprop=wordCount content="2994"><meta itemprop=keywords content="k8s,云原生,kubernetes,"><meta name=twitter:card content="summary"><meta name=twitter:title content="第三章 Kubernetes 资源管理"><meta name=twitter:description content="本章节主要介绍yaml语法和kubernetes的资源管理方式 资源管理介绍 在kubernetes中，所有的内容都抽象为资源，用户需要通过操作"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>空樹之空</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><li class=mobile-menu-item><a class=menu-item-link href=/>首页</a></li><li class=mobile-menu-item><a class=menu-item-link href=/post.html>归档</a></li><li class=mobile-menu-item><a class=menu-item-link href=/tags.html>标签云</a></li><li class=mobile-menu-item><a class=menu-item-link href=/categories.html>分类</a></li><li class=mobile-menu-item><div class=mobile-menu-parent><span class=mobile-submenu-open></span><a href>教程</a></div><ul class=mobile-submenu-list><li><a href=/categories/go%E6%95%99%E7%A8%8B.html>Go 实践教程</a></li><li><a href=/tags/docker%E6%95%99%E7%A8%8B.html>Docker笔记</a></li><li><a href=/tags/elk.html>ELK入门</a></li><li><a href=/tags/prometheus.html>Prometheus</a></li><li><a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html>设计模式</a></li><li><a href=/tags/kubernetes.html>Kubernetes 笔记整理</a></li></ul></li><li class=mobile-menu-item><div class=mobile-menu-parent><span class=mobile-submenu-open></span><a href>自我驱动</a></div><ul class=mobile-submenu-list><li><a href=/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html>读书笔记</a></li><li><a href=/tags/%E5%B7%A5%E7%A8%8B%E5%B8%88.html>工程师</a></li><li><a href=/tags/%E5%88%86%E4%BA%AB.html>价值分享</a></li></ul></li><li class=mobile-menu-item><a class=menu-item-link href=/about.html>地图</a></li></ul></nav><link rel=stylesheet href=/lib/photoswipe/photoswipe.min.css><link rel=stylesheet href=/lib/photoswipe/default-skin/default-skin.min.css><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><style>.fork-me-on-github{position:absolute;top:0;left:0;border:0}@media(max-width:1080px){.fork-me-on-github{display:none}}</style><a href=https://github.com/yezihack><img class=fork-me-on-github src=https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png alt="Fork me on GitHub"></a><header id=header class="header container"><div class=logo-wrapper><a href=/ class=logo>空樹之空</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>首页</a></li><li class=menu-item><a class=menu-item-link href=/post.html>归档</a></li><li class=menu-item><a class=menu-item-link href=/tags.html>标签云</a></li><li class=menu-item><a class=menu-item-link href=/categories.html>分类</a></li><li class=menu-item><a class="menu-item-link menu-parent" href>教程</a><ul class=submenu><li><a href=/categories/go%E6%95%99%E7%A8%8B.html>Go 实践教程</a></li><li><a href=/tags/docker%E6%95%99%E7%A8%8B.html>Docker笔记</a></li><li><a href=/tags/elk.html>ELK入门</a></li><li><a href=/tags/prometheus.html>Prometheus</a></li><li><a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html>设计模式</a></li><li><a href=/tags/kubernetes.html>Kubernetes 笔记整理</a></li></ul></li><li class=menu-item><a class="menu-item-link menu-parent" href>自我驱动</a><ul class=submenu><li><a href=/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html>读书笔记</a></li><li><a href=/tags/%E5%B7%A5%E7%A8%8B%E5%B8%88.html>工程师</a></li><li><a href=/tags/%E5%88%86%E4%BA%AB.html>价值分享</a></li></ul></li><li class=menu-item><a class=menu-item-link href=/about.html>地图</a></li></ul></nav></header><div id=mobile-panel><main id=main class="main bg-llight"><div class=content-wrapper><div id=content class="content container"><article class="post bg-white"><header class=post-header><h1 class=post-title>第三章 Kubernetes 资源管理</h1><div class=post-meta><time datetime=2021-10-28 class=post-time>2021-10-28</time><div class=post-category><a href=/categories/kubernetes.html>kubernetes</a></div><span class=more-meta>约 2994 字</span>
<span class=more-meta>预计阅读 6 分钟</span>
<span id=busuanzi_container_page_pv>| 阅读 <span id=busuanzi_value_page_pv></span></span></div></header><div id=post-toc><aside><header><h3>第三章 Kubernetes 资源管理</h3></header><nav id=TableOfContents><ul><li><a href=#资源管理介绍>资源管理介绍</a></li><li><a href=#yaml语言介绍>YAML语言介绍</a></li><li><a href=#资源管理方式>资源管理方式</a><ul><li><a href=#命令式对象管理>命令式对象管理</a></li><li><a href=#命令式对象配置>命令式对象配置</a></li><li><a href=#声明式对象配置>声明式对象配置</a></li></ul></li><li><a href=#参考>参考</a></li><li><a href=#关于作者>关于作者</a></li></ul></nav></aside><a href=# id=toc-toggle></a></div><div class=post-content><blockquote><p>本章节主要介绍yaml语法和kubernetes的资源管理方式</p></blockquote><h2 id=资源管理介绍>资源管理介绍</h2><p>在kubernetes中，所有的内容都抽象为资源，用户需要通过操作资源来管理kubernetes。</p><blockquote><p>kubernetes的本质上就是一个集群系统，用户可以在集群中部署各种服务，所谓的部署服务，其实就是在kubernetes集群中运行一个个的容器，并将指定的程序跑在容器中。</p><p>kubernetes的最小管理单元是pod而不是容器，所以只能将容器放在<code>Pod</code>中，而kubernetes一般也不会直接管理Pod，而是通过<code>Pod控制器</code>来管理Pod的。</p><p>Pod可以提供服务之后，就要考虑如何访问Pod中服务，kubernetes提供了<code>Service</code>资源实现这个功能。</p><p>当然，如果Pod中程序的数据需要持久化，kubernetes还提供了各种<code>存储</code>系统。</p></blockquote><p><img src=https://cdn.jsdelivr.net/gh/yezihack/assets/b/image-20200406225334627.png?imageslim alt></p><blockquote><p>学习kubernetes的核心，就是学习如何对集群上的<code>Pod、Pod控制器、Service、存储</code>等各种资源进行操作</p></blockquote><h2 id=yaml语言介绍>YAML语言介绍</h2><p>YAML是一个类似 XML、JSON 的标记性语言。它强调以<strong>数据</strong>为中心，并不是以标识语言为重点。因而YAML本身的定义比较简单，号称"一种人性化的数据格式语言"。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;heima&gt;</span>
	<span class=nt>&lt;age&gt;</span>15<span class=nt>&lt;/age&gt;</span>
    <span class=nt>&lt;address&gt;</span>Beijing<span class=nt>&lt;/address&gt;</span>
<span class=nt>&lt;/heima&gt;</span>
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>heima</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>age</span><span class=p>:</span><span class=w> </span><span class=m>15</span><span class=w>
</span><span class=w>  </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=l>Beijing</span><span class=w>
</span></code></pre></td></tr></table></div></div><p>YAML的语法比较简单，主要有下面几个：</p><ul><li>大小写敏感</li><li>使用缩进表示层级关系</li><li>缩进不允许使用tab，只允许空格( 低版本限制 )</li><li>缩进的空格数不重要，只要相同层级的元素左对齐即可</li><li>&lsquo;#&lsquo;表示注释</li></ul><p>YAML支持以下几种数据类型：</p><ul><li>纯量：单个的、不可再分的值</li><li>对象：键值对的集合，又称为映射（mapping）/ 哈希（hash） / 字典（dictionary）</li><li>数组：一组按次序排列的值，又称为序列（sequence） / 列表（list）</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=c># 纯量, 就是指的一个简单的值，字符串、布尔值、整数、浮点数、Null、时间、日期</span><span class=w>
</span><span class=w></span><span class=c># 1 布尔类型</span><span class=w>
</span><span class=w></span><span class=nt>c1</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w> </span><span class=l>(或者True)</span><span class=w>
</span><span class=w></span><span class=c># 2 整型</span><span class=w>
</span><span class=w></span><span class=nt>c2</span><span class=p>:</span><span class=w> </span><span class=m>234</span><span class=w>
</span><span class=w></span><span class=c># 3 浮点型</span><span class=w>
</span><span class=w></span><span class=nt>c3</span><span class=p>:</span><span class=w> </span><span class=m>3.14</span><span class=w>
</span><span class=w></span><span class=c># 4 null类型 </span><span class=w>
</span><span class=w></span><span class=nt>c4</span><span class=p>:</span><span class=w> </span><span class=l>~ </span><span class=w> </span><span class=c># 使用~表示null</span><span class=w>
</span><span class=w></span><span class=c># 5 日期类型</span><span class=w>
</span><span class=w></span><span class=nt>c5</span><span class=p>:</span><span class=w> </span><span class=ld>2018-02-17</span><span class=w>    </span><span class=c># 日期必须使用ISO 8601格式，即yyyy-MM-dd</span><span class=w>
</span><span class=w></span><span class=c># 6 时间类型</span><span class=w>
</span><span class=w></span><span class=nt>c6</span><span class=p>:</span><span class=w> </span><span class=ld>2018-02-17T15:02:31</span><span class=m>+08</span><span class=p>:</span><span class=m>00</span><span class=w>  </span><span class=c># 时间使用ISO 8601格式，时间和日期之间使用T连接，最后使用+代表时区</span><span class=w>
</span><span class=w></span><span class=c># 7 字符串类型</span><span class=w>
</span><span class=w></span><span class=nt>c7</span><span class=p>:</span><span class=w> </span><span class=l>heima    </span><span class=w> </span><span class=c># 简单写法，直接写值 , 如果字符串中间有特殊字符，必须使用双引号或者单引号包裹 </span><span class=w>
</span><span class=w></span><span class=nt>c8</span><span class=p>:</span><span class=w> </span><span class=l>line1</span><span class=w>
</span><span class=w>    </span><span class=l>line2    </span><span class=w> </span><span class=c># 字符串过多的情况可以拆成多行，每一行会被转化成一个空格</span><span class=w>
</span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=c># 对象</span><span class=w>
</span><span class=w></span><span class=c># 形式一(推荐):</span><span class=w>
</span><span class=w></span><span class=nt>heima</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>age</span><span class=p>:</span><span class=w> </span><span class=m>15</span><span class=w>
</span><span class=w>  </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=l>Beijing</span><span class=w>
</span><span class=w></span><span class=c># 形式二(了解):</span><span class=w>
</span><span class=w></span><span class=nt>heima</span><span class=p>:</span><span class=w> </span>{<span class=nt>age: 15,address</span><span class=p>:</span><span class=w> </span><span class=l>Beijing}</span><span class=w>
</span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=c># 数组</span><span class=w>
</span><span class=w></span><span class=c># 形式一(推荐):</span><span class=w>
</span><span class=w></span><span class=nt>address</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=l>顺义</span><span class=w>
</span><span class=w>  </span>- <span class=l>昌平	</span><span class=w>
</span><span class=w></span><span class=c># 形式二(了解):</span><span class=w>
</span><span class=w></span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>顺义,昌平]</span><span class=w>
</span></code></pre></td></tr></table></div></div><blockquote><p>小提示：</p><p>1 书写yaml切记<code>:</code> 后面要加一个空格</p><p>2 如果需要将多段yaml配置放在一个文件中，中间要使用<code>---</code>分隔</p><p>3 下面是一个yaml转json的网站，可以通过它验证yaml是否书写正确</p></blockquote><p><a href=https://www.json2yaml.com/convert-yaml-to-json>YAML转JSON</a></p><h2 id=资源管理方式>资源管理方式</h2><ul><li><p>命令式对象管理：直接使用命令去操作kubernetes资源</p><p><code>kubectl run nginx-pod --image=nginx:1.17.1 --port=80</code></p></li><li><p>命令式对象配置：通过命令配置和配置文件去操作kubernetes资源</p><p><code>kubectl create/patch -f nginx-pod.yaml</code></p></li><li><p>声明式对象配置：通过apply命令和配置文件去操作kubernetes资源</p><p><code>kubectl apply -f nginx-pod.yaml</code></p></li></ul><table><thead><tr><th>类型</th><th>操作对象</th><th>适用环境</th><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td>命令式对象管理</td><td>对象</td><td>测试</td><td>简单</td><td>只能操作活动对象，无法审计、跟踪</td></tr><tr><td>命令式对象配置</td><td>文件</td><td>开发</td><td>可以审计、跟踪</td><td>项目大时，配置文件多，操作麻烦</td></tr><tr><td>声明式对象配置</td><td>目录</td><td>开发</td><td>支持目录操作</td><td>意外情况下难以调试</td></tr></tbody></table><h3 id=命令式对象管理>命令式对象管理</h3><p><strong>kubectl命令</strong></p><p>kubectl是kubernetes集群的命令行工具，通过它能够对集群本身进行管理，并能够在集群上进行容器化应用的安装部署。kubectl命令的语法如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-md data-lang=md>kubectl [command] [type] [name] [flags]
</code></pre></td></tr></table></div></div><p><strong>comand</strong>：指定要对资源执行的操作，例如create、get、delete</p><p><strong>type</strong>：指定资源类型，比如deployment、pod、service</p><p><strong>name</strong>：指定资源的名称，名称大小写敏感</p><p><strong>flags</strong>：指定额外的可选参数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=c># 查看所有pod</span>
<span class=n>kubectl</span> <span class=n>get</span> <span class=n>pod</span> 

<span class=c># 查看某个pod</span>
<span class=n>kubectl</span> <span class=n>get</span> <span class=n>pod</span> <span class=n>pod_name</span>

<span class=c># 查看某个pod,以yaml格式展示结果</span>
<span class=n>kubectl</span> <span class=n>get</span> <span class=n>pod</span> <span class=n>pod_name</span> <span class=n>-o</span> <span class=n>yaml</span>
</code></pre></td></tr></table></div></div><p><strong>资源类型</strong></p><p>kubernetes中所有的内容都抽象为资源，可以通过下面的命令进行查看:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>kubectl</span> <span class=n>api-resources</span>
</code></pre></td></tr></table></div></div><p>经常使用的资源有下面这些：</p><p><strong>操作</strong></p><p>kubernetes允许对资源进行多种操作，可以通过&ndash;help查看详细的操作命令</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>kubectl</span> <span class=p>-</span><span class=n>-help</span>
</code></pre></td></tr></table></div></div><p>经常使用的操作有下面这些：</p><p>下面以一个namespace / pod的创建和删除简单演示下命令的使用：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=c># 创建一个namespace</span>
<span class=p>[</span><span class=n>root</span><span class=nv>@master</span> <span class=p>~]</span><span class=c># kubectl create namespace dev</span>
<span class=n>namespace</span><span class=p>/</span><span class=n>dev</span> <span class=n>created</span>

<span class=c># 获取namespace</span>
<span class=p>[</span><span class=n>root</span><span class=nv>@master</span> <span class=p>~]</span><span class=c># kubectl get ns</span>
<span class=n>NAME</span>              <span class=n>STATUS</span>   <span class=n>AGE</span>
<span class=k>default</span>           <span class=n>Active</span>   <span class=n>21h</span>
<span class=n>dev</span>               <span class=n>Active</span>   <span class=n>21s</span>
<span class=n>kube-node-lease</span>   <span class=n>Active</span>   <span class=n>21h</span>
<span class=n>kube-public</span>       <span class=n>Active</span>   <span class=n>21h</span>
<span class=n>kube-system</span>       <span class=n>Active</span>   <span class=n>21h</span>

<span class=c># 在此namespace下创建并运行一个nginx的Pod</span>
<span class=p>[</span><span class=n>root</span><span class=nv>@master</span> <span class=p>~]</span><span class=c># kubectl run pod --image=nginx -n dev</span>
<span class=n>kubectl</span> <span class=n>run</span> <span class=p>-</span><span class=n>-generator</span><span class=p>=</span><span class=n>deployment</span><span class=p>/</span><span class=n>apps</span><span class=p>.</span><span class=n>v1</span> <span class=n>is</span> <span class=n>DEPRECATED</span> <span class=n>and</span> <span class=n>will</span> <span class=n>be</span> <span class=n>removed</span> <span class=k>in</span> <span class=n>a</span> <span class=n>future</span> <span class=n>version</span><span class=p>.</span> <span class=n>Use</span> <span class=n>kubectl</span> <span class=n>run</span> <span class=p>-</span><span class=n>-generator</span><span class=p>=</span><span class=n>run-pod</span><span class=p>/</span><span class=n>v1</span> <span class=n>or</span> <span class=n>kubectl</span> <span class=n>create</span> <span class=n>instead</span><span class=p>.</span>
<span class=n>deployment</span><span class=p>.</span><span class=n>apps</span><span class=p>/</span><span class=n>pod</span> <span class=n>created</span>

<span class=c># 查看新创建的pod</span>
<span class=p>[</span><span class=n>root</span><span class=nv>@master</span> <span class=p>~]</span><span class=c># kubectl get pod -n dev</span>
<span class=n>NAME</span>                   <span class=n>READY</span>   <span class=n>STATUS</span>    <span class=n>RESTARTS</span>   <span class=n>AGE</span>
<span class=n>pod</span><span class=p>-</span><span class=n>864f9875b9-pcw7x</span>   <span class=n>1</span><span class=p>/</span><span class=n>1</span>     <span class=n>Running</span>   <span class=n>0</span>          <span class=n>21s</span>

<span class=c># 删除指定的pod</span>
<span class=p>[</span><span class=n>root</span><span class=nv>@master</span> <span class=p>~]</span><span class=c># kubectl delete pod pod-864f9875b9-pcw7x</span>
<span class=n>pod</span> <span class=s2>&#34;pod-864f9875b9-pcw7x&#34;</span> <span class=n>deleted</span>

<span class=c># 删除指定的namespace</span>
<span class=p>[</span><span class=n>root</span><span class=nv>@master</span> <span class=p>~]</span><span class=c># kubectl delete ns dev</span>
<span class=n>namespace</span> <span class=s2>&#34;dev&#34;</span> <span class=n>deleted</span>
</code></pre></td></tr></table></div></div><h3 id=命令式对象配置>命令式对象配置</h3><p>命令式对象配置就是使用命令配合配置文件一起来操作kubernetes资源。</p><p>1） 创建一个nginxpod.yaml，内容如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Namespace</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>dev</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=nn>---</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Pod</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginxpod</span><span class=w>
</span><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>dev</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx-containers</span><span class=w>
</span><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>nginx:1.17.1</span><span class=w>
</span></code></pre></td></tr></table></div></div><p>2）执行create命令，创建资源：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=p>[</span><span class=n>root</span><span class=nv>@master</span> <span class=p>~]</span><span class=c># kubectl create -f nginxpod.yaml</span>
<span class=n>namespace</span><span class=p>/</span><span class=n>dev</span> <span class=n>created</span>
<span class=n>pod</span><span class=p>/</span><span class=n>nginxpod</span> <span class=n>created</span>
</code></pre></td></tr></table></div></div><p>此时发现创建了两个资源对象，分别是namespace和pod</p><p>3）执行get命令，查看资源：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=p>[</span><span class=n>root</span><span class=nv>@master</span> <span class=p>~]</span><span class=c>#  kubectl get -f nginxpod.yaml</span>
<span class=n>NAME</span>            <span class=n>STATUS</span>   <span class=n>AGE</span>
<span class=n>namespace</span><span class=p>/</span><span class=n>dev</span>   <span class=n>Active</span>   <span class=n>18s</span>

<span class=n>NAME</span>            <span class=n>READY</span>   <span class=n>STATUS</span>    <span class=n>RESTARTS</span>   <span class=n>AGE</span>
<span class=n>pod</span><span class=p>/</span><span class=n>nginxpod</span>    <span class=n>1</span><span class=p>/</span><span class=n>1</span>     <span class=n>Running</span>   <span class=n>0</span>          <span class=n>17s</span>
</code></pre></td></tr></table></div></div><p>这样就显示了两个资源对象的信息</p><p>4）执行delete命令，删除资源：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=p>[</span><span class=n>root</span><span class=nv>@master</span> <span class=p>~]</span><span class=c># kubectl delete -f nginxpod.yaml</span>
<span class=n>namespace</span> <span class=s2>&#34;dev&#34;</span> <span class=n>deleted</span>
<span class=n>pod</span> <span class=s2>&#34;nginxpod&#34;</span> <span class=n>deleted</span>
</code></pre></td></tr></table></div></div><p>此时发现两个资源对象被删除了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-md data-lang=md>总结:
	命令式对象配置的方式操作资源，可以简单的认为：命令  +  yaml配置文件（里面是命令需要的各种参数）
</code></pre></td></tr></table></div></div><h3 id=声明式对象配置>声明式对象配置</h3><p>声明式对象配置跟命令式对象配置很相似，但是它只有一个命令apply。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=c># 首先执行一次kubectl apply -f yaml文件，发现创建了资源</span>
<span class=p>[</span><span class=n>root</span><span class=nv>@master</span> <span class=p>~]</span><span class=c>#  kubectl apply -f nginxpod.yaml</span>
<span class=n>namespace</span><span class=p>/</span><span class=n>dev</span> <span class=n>created</span>
<span class=n>pod</span><span class=p>/</span><span class=n>nginxpod</span> <span class=n>created</span>

<span class=c># 再次执行一次kubectl apply -f yaml文件，发现说资源没有变动</span>
<span class=p>[</span><span class=n>root</span><span class=nv>@master</span> <span class=p>~]</span><span class=c>#  kubectl apply -f nginxpod.yaml</span>
<span class=n>namespace</span><span class=p>/</span><span class=n>dev</span> <span class=n>unchanged</span>
<span class=n>pod</span><span class=p>/</span><span class=n>nginxpod</span> <span class=n>unchanged</span>
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-md data-lang=md>总结:
    其实声明式对象配置就是使用apply描述一个资源最终的状态（在yaml中定义状态）
	使用apply操作资源：
        如果资源不存在，就创建，相当于 kubectl create
		如果资源已存在，就更新，相当于 kubectl patch
</code></pre></td></tr></table></div></div><blockquote><p>扩展：kubectl可以在node节点上运行吗 ?</p></blockquote><pre><code>kubectl的运行是需要进行配置的，它的配置文件是\$HOME/.kube，如果想要在node节点运行此命令，需要将master上的.kube文件复制到node节点上，即在master节点上执行下面操作：
</code></pre><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-powershell data-lang=powershell><span class=n>scp</span>  <span class=n>-r</span>  <span class=n>HOME</span><span class=p>/.</span><span class=n>kube</span>   <span class=n>node1</span><span class=err>:</span> <span class=n>HOME</span><span class=p>/</span>
</code></pre></td></tr></table></div></div><blockquote><p>使用推荐: 三种方式应该怎么用 ?</p></blockquote><p>创建/更新资源 使用声明式对象配置 kubectl apply -f XXX.yaml</p><p>删除资源 使用命令式对象配置 kubectl delete -f XXX.yaml</p><p>查询资源 使用命令式对象管理 kubectl get(describe) 资源名称</p><h2 id=参考>参考</h2><ol><li>以上笔记来自于黑马视频课程整理.</li><li>视频入口：<a href=https://www.bilibili.com/video/BV1cK4y1L7Am>https://www.bilibili.com/video/BV1cK4y1L7Am</a></li></ol><h2 id=关于作者>关于作者</h2><p>我的博客：https://www.sgfoot.com</p><p>欢迎关注我的微信公众号【空树之空】，共同学习，一起进步~
<img src=https://cdn.jsdelivr.net/gh/yezihack/assets/b/20210122112114.png?imageslim alt=空树之空></p></div><div class=post-copyright><p class=copyright-item><span class=item-title>文章作者</span>
<span class=item-content>百里</span></p><p class=copyright-item><span class=item-title>上次更新</span>
<span class=item-content>2021-10-28</span></p><p class=copyright-item><span class=item-title>许可协议</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></p></div><h1></h1><div class=post-reward><input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>赞赏支持</label><div class=qr-code><label class=qr-code-image for=reward><img class=image src=https://cdn.jsdelivr.net/gh/yezihack/assets/b/20200417142450.jpg?imageslim>
<span>微信打赏</span></label></div></div><footer class=post-footer><div class=post-tags><a href=/tags/k8s.html>k8s</a>
<a href=/tags/%E4%BA%91%E5%8E%9F%E7%94%9F.html>云原生</a>
<a href=/tags/kubernetes.html>kubernetes</a></div><nav class=post-nav><a class=prev href=/k8s-operation.html><i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417l277.93508-310.326815c11.338233-12.190647 11.035334-32.285311-.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"/></svg></i><span class="prev-text nav-default">第四章 Kubernetes 实战操作</span>
<span class="prev-text nav-mobile">上一篇</span></a>
<a class=next href=/k8s-install.html><span class="next-text nav-default">第二章 Kubernetes 安装</span>
<span class="prev-text nav-mobile">下一篇</span>
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"/></svg></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=icon-links><a href=mailto:freeit@126.com rel="me noopener" class=iconfont title=email><svg class="icon" viewBox="0 0 1451 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M664.781909 681.472759.0 97.881301C0 3.997201 71.046997.0 71.046997.0H474.477909 961.649408 1361.641813S1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759S764.482731 685.154773 753.594283 688.65053V688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858V688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759zM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633.0 212.052267.0 212.052267V942.809523L83.726336 1024H682.532949 753.579947 1348.948139L1432.688811 942.809523V212.052267S893.138176 701.759633 817.019477 767.734955C777.248 802.205449 742.347691 811.03081 718.063616 811.603883z"/></svg></a><a href=https://www.github.com/yezihack rel="me noopener" class=iconfont title=github target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M512 12.672c-282.88.0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667.0-12.16-.426667-44.373333-.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333.0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333.0.0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667.0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72.0 68.522667-.64 123.562667-.64 140.202666.0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"/></svg></a><a href=/index.xml rel="noopener alternate" type=application/rss+xml class=iconfont title=rss target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><path d="M819.157333 1024C819.157333 574.592 449.408 204.8.0 204.8V0c561.706667.0 1024 462.293333 1024 1024H819.157333zM140.416 743.04a140.8 140.8.0 01140.501333 140.586667A140.928 140.928.0 01140.074667 1024C62.72 1024 0 961.109333.0 883.626667S62.933333 743.082667 140.416 743.04zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352.0 678.784 306.517333 678.784 678.826667z"/></svg></a></div><div class=copyright><span class=copyright-year>&copy;
2020 -
2022
<span class=heart><i class=iconfont><svg class="icon" viewBox="0 0 1025 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14"><path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7.0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1.0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2.0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3.1-42.5-8-83.6-24-122.2z" fill="#8a8a8a"/></svg></i></span><span class=author><a href=https://www.sgfoot.com>空樹之空</a>
</span><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme - <a class=theme-link href=https://github.com/xianmin/hugo-theme-jane>Jane</a></span></span>
<span id=busuanzi_container>访客数/访问量：<span id=busuanzi_value_site_uv></span>/<span id=busuanzi_value_site_pv></span></span></div></footer><div class=back-to-top id=back-to-top><i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="35" height="35"><path d="M510.866688 227.694839 95.449397 629.218702h235.761562L329.15309 958.01517h362.40389L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777h894.052392v131.813095H63.840492V63.962777zm0 0"/></svg></i></div></div><script type=text/javascript src=/lib/jquery/jquery-3.2.1.min.js></script><script type=text/javascript src=/lib/slideout/slideout-1.0.1.min.js></script><script type=text/javascript src=/js/main.c123da21eb8e940c0619f739a9ba5a0058720dfae9a96bafc91016c54983880f.js integrity="sha256-wSPaIeuOlAwGGfc5qbpaAFhyDfrpqWuvyRAWxUmDiA8=" crossorigin=anonymous></script><script id=baidu_analytics>var _hmt=_hmt||[];(function(){if(window.location.hostname==='localhost')return;var hm=document.createElement("script");hm.async=true;hm.src="https://hm.baidu.com/hm.js?90b270e075265ec9aad9847f47bb1f42";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script><script id=baidu_push>(function(){if(window.location.hostname==='localhost')return;var bp=document.createElement('script');bp.async=true;var curProtocol=window.location.protocol.split(':')[0];if(curProtocol==='https'){bp.src='https://zz.bdstatic.com/linksubmit/push.js';}
else{bp.src='http://push.zhanzhang.baidu.com/push.js';}
var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script><script type=text/javascript src=/js/load-photoswipe.js></script><script type=text/javascript src=/lib/photoswipe/photoswipe.min.js></script><script type=text/javascript src=/lib/photoswipe/photoswipe-ui-default.min.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script></body></html>