<!doctype html><html lang=zh-cn itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>第十二章 Minikube 安装 - 空樹之空的博客</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=MobileOptimized content="width"><meta name=HandheldFriendly content="true"><meta name=applicable-device content="pc,mobile"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=mobile-web-app-capable content="yes"><meta name=author content="百里"><meta name=description content="Minikube 安装 仅用于开产使用，生产不能使用。 以下仅以 macOS 系统演示 1.1 Docker 安装 官方下载，直接安装即可。 https://docs.docker.com/desktop/mac/install/ 使用国内镜像源，推荐阿里云的。 参考：https://"><meta name=keywords content="Go语言,MySQL,Redis,设计模式,读书笔记,人生感悟"><meta name=generator content="Hugo 0.79.1"><link rel=canonical href=/k8s-minikube.html><link rel=icon href=/favicon.ico><link rel=stylesheet href=/sass/jane.min.021cece56b7a73d45503de6c44a7f04dc9247fa4d50d932d81c81d1f76ef1efe.css integrity="sha256-Ahzs5Wt6c9RVA95sRKfwTckkf6TVDZMtgcgdH3bvHv4=" media=screen crossorigin=anonymous><link rel=stylesheet href=/css/toc.css><meta property="og:title" content="第十二章 Minikube 安装"><meta property="og:description" content="Minikube 安装 仅用于开产使用，生产不能使用。 以下仅以 macOS 系统演示 1.1 Docker 安装 官方下载，直接安装即可。 https://docs.docker.com/desktop/mac/install/ 使用国内镜像源，推荐阿里云的。 参考：https://"><meta property="og:type" content="article"><meta property="og:url" content="/k8s-minikube.html"><meta property="article:published_time" content="2021-12-28T17:39:06+08:00"><meta property="article:modified_time" content="2021-12-28T17:39:06+08:00"><meta itemprop=name content="第十二章 Minikube 安装"><meta itemprop=description content="Minikube 安装 仅用于开产使用，生产不能使用。 以下仅以 macOS 系统演示 1.1 Docker 安装 官方下载，直接安装即可。 https://docs.docker.com/desktop/mac/install/ 使用国内镜像源，推荐阿里云的。 参考：https://"><meta itemprop=datePublished content="2021-12-28T17:39:06+08:00"><meta itemprop=dateModified content="2021-12-28T17:39:06+08:00"><meta itemprop=wordCount content="2184"><meta itemprop=keywords content="k8s,云原生,kubernetes,k8s安装,"><meta name=twitter:card content="summary"><meta name=twitter:title content="第十二章 Minikube 安装"><meta name=twitter:description content="Minikube 安装 仅用于开产使用，生产不能使用。 以下仅以 macOS 系统演示 1.1 Docker 安装 官方下载，直接安装即可。 https://docs.docker.com/desktop/mac/install/ 使用国内镜像源，推荐阿里云的。 参考：https://"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>空樹之空</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><li class=mobile-menu-item><a class=menu-item-link href=/>首页</a></li><li class=mobile-menu-item><a class=menu-item-link href=/post.html>归档</a></li><li class=mobile-menu-item><a class=menu-item-link href=/tags.html>标签云</a></li><li class=mobile-menu-item><a class=menu-item-link href=/categories.html>分类</a></li><li class=mobile-menu-item><div class=mobile-menu-parent><span class=mobile-submenu-open></span><a href>教程</a></div><ul class=mobile-submenu-list><li><a href=/categories/go%E6%95%99%E7%A8%8B.html>Go 实践教程</a></li><li><a href=/tags/docker%E6%95%99%E7%A8%8B.html>Docker笔记</a></li><li><a href=/tags/elk.html>ELK入门</a></li><li><a href=/tags/prometheus.html>Prometheus</a></li><li><a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html>设计模式</a></li><li><a href=/tags/kubernetes.html>Kubernetes 笔记整理</a></li></ul></li><li class=mobile-menu-item><div class=mobile-menu-parent><span class=mobile-submenu-open></span><a href>自我驱动</a></div><ul class=mobile-submenu-list><li><a href=/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html>读书笔记</a></li><li><a href=/tags/%E5%B7%A5%E7%A8%8B%E5%B8%88.html>工程师</a></li><li><a href=/tags/%E5%88%86%E4%BA%AB.html>价值分享</a></li></ul></li><li class=mobile-menu-item><a class=menu-item-link href=/about.html>地图</a></li></ul></nav><link rel=stylesheet href=/lib/photoswipe/photoswipe.min.css><link rel=stylesheet href=/lib/photoswipe/default-skin/default-skin.min.css><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><style>.fork-me-on-github{position:absolute;top:0;left:0;border:0}@media(max-width:1080px){.fork-me-on-github{display:none}}</style><a href=https://github.com/yezihack><img class=fork-me-on-github src=https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png alt="Fork me on GitHub"></a><header id=header class="header container"><div class=logo-wrapper><a href=/ class=logo>空樹之空</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>首页</a></li><li class=menu-item><a class=menu-item-link href=/post.html>归档</a></li><li class=menu-item><a class=menu-item-link href=/tags.html>标签云</a></li><li class=menu-item><a class=menu-item-link href=/categories.html>分类</a></li><li class=menu-item><a class="menu-item-link menu-parent" href>教程</a><ul class=submenu><li><a href=/categories/go%E6%95%99%E7%A8%8B.html>Go 实践教程</a></li><li><a href=/tags/docker%E6%95%99%E7%A8%8B.html>Docker笔记</a></li><li><a href=/tags/elk.html>ELK入门</a></li><li><a href=/tags/prometheus.html>Prometheus</a></li><li><a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html>设计模式</a></li><li><a href=/tags/kubernetes.html>Kubernetes 笔记整理</a></li></ul></li><li class=menu-item><a class="menu-item-link menu-parent" href>自我驱动</a><ul class=submenu><li><a href=/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html>读书笔记</a></li><li><a href=/tags/%E5%B7%A5%E7%A8%8B%E5%B8%88.html>工程师</a></li><li><a href=/tags/%E5%88%86%E4%BA%AB.html>价值分享</a></li></ul></li><li class=menu-item><a class=menu-item-link href=/about.html>地图</a></li></ul></nav></header><div id=mobile-panel><main id=main class="main bg-llight"><div class=content-wrapper><div id=content class="content container"><article class="post bg-white"><header class=post-header><h1 class=post-title>第十二章 Minikube 安装</h1><div class=post-meta><time datetime=2021-12-28 class=post-time>2021-12-28</time><div class=post-category><a href=/categories/kubernetes.html>kubernetes</a></div><span class=more-meta>约 2184 字</span>
<span class=more-meta>预计阅读 5 分钟</span>
<span id=busuanzi_container_page_pv>| 阅读 <span id=busuanzi_value_page_pv></span></span></div></header><div id=post-toc><aside><header><h3>第十二章 Minikube 安装</h3></header><nav id=TableOfContents><ul><li><a href=#11-docker-安装>1.1 Docker 安装</a></li><li><a href=#12-kubectl-安装>1.2 Kubectl 安装</a></li><li><a href=#13-minikube安装>1.3 Minikube安装</a></li><li><a href=#14-运行一个完整的-web-nginx-应用>1.4 运行一个完整的 web nginx 应用</a></li><li><a href=#15-运行dashboard>1.5 运行Dashboard</a></li><li><a href=#参考文档>参考文档</a></li><li><a href=#关于作者>关于作者</a></li></ul></nav></aside><a href=# id=toc-toggle></a></div><div class=post-content><h1 id=minikube-安装>Minikube 安装</h1><blockquote><p>仅用于开产使用，生产不能使用。
以下仅以 macOS 系统演示</p></blockquote><h2 id=11-docker-安装>1.1 Docker 安装</h2><p>官方下载，直接安装即可。</p><p><a href=https://docs.docker.com/desktop/mac/install/>https://docs.docker.com/desktop/mac/install/</a></p><p>使用国内镜像源，推荐阿里云的。</p><p>参考：<a href=https://sgfoot.com/docker-install.html#docker-%E5%8A%A0%E9%80%9F>https://sgfoot.com/docker-install.html#docker-加速</a></p><h2 id=12-kubectl-安装>1.2 Kubectl 安装</h2><p>Kubernetes 命令行工具，<a href=https://kubernetes.io/docs/reference/kubectl/kubectl/>kubectl</a>，使得你可以对 Kubernetes 集群运行命令。 你可以使用 kubectl 来部署应用、监测和管理集群资源以及查看日志。</p><p>官方下载，有详细的安装流程。支持：windows, linux, macOS</p><p>参考：<a href=https://kubernetes.io/zh/docs/tasks/tools/install-kubectl-macos/>https://kubernetes.io/zh/docs/tasks/tools/install-kubectl-macos/</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh><span class=c1># Apple Silicon M1 cpu</span>
curl -LO <span class=s2>&#34;https://dl.k8s.io/release/</span><span class=k>$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span class=k>)</span><span class=s2>/bin/darwin/arm64/kubectl&#34;</span>
 
<span class=c1># Intel cpu</span>
curl -LO <span class=s2>&#34;https://dl.k8s.io/release/</span><span class=k>$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span class=k>)</span><span class=s2>/bin/darwin/amd64/kubectl&#34;</span>

</code></pre></td></tr></table></div></div><p>添加权限，加入 PATH 目录</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># 添加执行权限</span>
chmod +x ./kubectl

<span class=c1># 移动到path目录，全局可访问</span>
sudo mv ./kubectl /usr/local/bin/kubectl
sudo chown root: /usr/local/bin/kubectl

<span class=c1># 查看版本</span>
kubectl version --client
</code></pre></td></tr></table></div></div><p>查看配置，<a href=https://kubernetes.io/zh/docs/reference/kubectl/overview/>了解更多 kubectl 命令</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># 查看 kubectl 配置，即读这里的信息：cat ~/.kube/config</span>
kubectl config view 
</code></pre></td></tr></table></div></div><h2 id=13-minikube安装>1.3 Minikube安装</h2><p>minikube 是一个单节点的 Kubernetes 集群，用于本地开展开发工作。</p><p>官方下载二进制包，选择你对应的操作系统。</p><p>下载地址：<a href=https://minikube.sigs.k8s.io/docs/start/>https://minikube.sigs.k8s.io/docs/start/</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># 添加执行权限</span>
chmod +x ./minikube

<span class=c1># 移动到path目录，全局可访问</span>
sudo mv ./minikube /usr/local/bin/minikube
sudo chown root: /usr/local/bin/minikube

<span class=c1># 启动集群</span>
minikube start --image-mirror-country<span class=o>=</span><span class=s1>&#39;cn&#39;</span>
	<span class=c1># cn 表示使用国内镜像源</span>
</code></pre></td></tr></table></div></div><p>参考：<a href=https://developer.aliyun.com/article/221687>https://developer.aliyun.com/article/221687</a></p><h2 id=14-运行一个完整的-web-nginx-应用>1.4 运行一个完整的 web nginx 应用</h2><blockquote><p>采用声明式对象配置安装一个 nginx 应用
格式：kubectl apply -f file-example.yaml</p></blockquote><p>新建 <code>web-nginx.yaml</code></p><ol><li>创建一个 web 命名空间</li><li>创建一个 Deployment ，将其运行在 web 空间下</li><li>创建一个 Service 服务，用于暴露服务</li></ol><blockquote><p>Yaml 简单语法说明：采用 key: value 形式，冒号后必须加一个空格，缩进以空格为主，三个中划线（&mdash;）表示在一个 yaml 文件里分隔多个yaml文件。<a href=https://www.ruanyifeng.com/blog/2016/07/yaml.html>更多 yaml 语法学习</a></p></blockquote><p>以下 web-nginx.yaml 一个文件里写了三处中划线，相当于三个 yaml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=c># 1. 创建一个独立的命名空间，方便做隔离区分。</span><span class=w>
</span><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Namespace</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w> 
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>web </span><span class=w> </span><span class=c># 创建一个新的命名空间</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=nn>---</span><span class=w>
</span><span class=w></span><span class=c># 2. 创建一个 deployment，设置 3 个副本数</span><span class=w>
</span><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment  </span><span class=w> </span><span class=c># 定义 deployment 对象，进行创建多个pod</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w> 
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>web-nginx-deployment </span><span class=w> </span><span class=c># deployment 名称</span><span class=w>
</span><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>web         </span><span class=w> </span><span class=c># 所属命名空间</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>             </span><span class=c># 选择标签</span><span class=w>
</span><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>        </span><span class=c># 采用匹配方式</span><span class=w>
</span><span class=w>      </span><span class=nt>app: web-nginx        # 标签名称: key </span><span class=p>:</span><span class=w> </span><span class=l>value 形式。即选择template下面 metadata.abels 定义的标签pod</span><span class=w>
</span><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>   </span><span class=c># 定义副本数，即 pod 的数量</span><span class=w>
</span><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>     </span><span class=c># 定义模板，即 pod 所需的容器</span><span class=w>
</span><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>   </span><span class=c># 基本信息</span><span class=w>
</span><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>   </span><span class=c># 定义 labels </span><span class=w>
</span><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>web-nginx</span><span class=w> </span><span class=c># 定义 pod 的标签，采用 key:value 形式</span><span class=w>
</span><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w> 
</span><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>  </span><span class=c># 定义容器信息</span><span class=w>
</span><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx </span><span class=w> </span><span class=c># 名称</span><span class=w>
</span><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>nginx:1.14.2 </span><span class=w> </span><span class=c># 镜像名称和版本号</span><span class=w>
</span><span class=w>        </span><span class=nt>ports</span><span class=p>:</span><span class=w>   </span><span class=c># 端口</span><span class=w>
</span><span class=w>        </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w> </span><span class=c># containerPort是在pod控制器中定义的、pod中的容器需要暴露的端口</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=nn>---</span><span class=w>
</span><span class=w></span><span class=c># 3. 创建一个 servive 向外暴露服务。 采用 NodePort 方式，即在 Node 上开设一个端口</span><span class=w>
</span><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>web-nginx-service</span><span class=w> </span><span class=c># 定义名称</span><span class=w>
</span><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>web         </span><span class=w> </span><span class=c># 运行在 web 空间下</span><span class=w>
</span><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>NodePort   </span><span class=w> </span><span class=c># 默认为ClusterIP，可选：NodePort（默认端口取值范围值：30000-32767), ExternalName, LoadBalancer  </span><span class=w>
</span><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w> 
</span><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>web-nginx  </span><span class=w> </span><span class=c># 选择 app=nginx 的 deployment </span><span class=w>
</span><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w> 
</span><span class=w>  </span>- <span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP    </span><span class=w> </span><span class=c># 采用 tcp 协议</span><span class=w>
</span><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>        </span><span class=c># 服务访问端口，集群内部访问的端口</span><span class=w>
</span><span class=w>    </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>  </span><span class=c># pod 控制器中定义的端口（应用访问的端口）</span><span class=w>
</span><span class=w>    </span><span class=c>#nodePort: 30003   # NodePort，外部客户端访问的端口</span><span class=w>
</span></code></pre></td></tr></table></div></div><p>使用 <code>kubectl apply -f web-nginx.yaml</code> 创建以上定义的服务</p><p>使用以下命令查看服务:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># 查看所有的命令空间, 可以看到创建的 web 空间， ns 是 namespace 的简写</span>
kubectl get ns 

<span class=c1># 查看创建的 Pod 服务, 需要使用 -n 指定命名空间</span>
kubectl get pods -n web 

<span class=c1># 查看 deployment 服务， deploy 是 deployment 的简写方式</span>
kubectl get deploy -n web

<span class=c1># 查看 service  服务， svc 是 service 的简写方式</span>
kubectl get svc -n web

<span class=c1># 查看 endpoints 服务,可以查看到 service 通过 endpoints 关联到 deployment 服务</span>
kubectl get ep -n web

</code></pre></td></tr></table></div></div><p>service 提供的ip还只是集群内部的ip，如何验证 nginx 呢，借用 minikube 提供的 service 功能，进行代理访问。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># 列出 service 服务名称。即 web-nginx-service 名称。</span>
kubectl get svc -n web

<span class=c1># 使用 minikube service 功能，注意需要指定命名空间，-n web</span>
minikube service web-nginx-service -n web
</code></pre></td></tr></table></div></div><p>更加详细的查看服务命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># 使用 describe 查看服务详情，适用于 pod, deployment, service, ep 等</span>
kubectl describe  svc -n web <span class=c1># 查看 service 详情</span>

<span class=c1># 使用 -o wide 浏览更多信息， 适用于 pod, deployment, service, ep 等</span>
kubectl get deploy -n web -o wide

<span class=c1># 进入容器内部</span>
kubectl <span class=nb>exec</span> -it nginx-deployment-66b6c48dd5-4js2m -n dev sh
	<span class=c1># nginx-deployment-66b6c48dd5-4js2m 名称是 pod 的名称。</span>
	<span class=c1># 可以使用  kubectl get pods -n web 查看到名称。</span>
	<span class=c1># sh 采用 shell 方式</span>
</code></pre></td></tr></table></div></div><h2 id=15-运行dashboard>1.5 运行Dashboard</h2><blockquote><p>官方出的 kubernetes web 界面，可以查看集群内的服务信息。</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># 默认打开浏览器，随机一个端口。</span>
minikube dashboard 

<span class=c1># 指定端口，显示URL,推荐使用</span>
minikube dashboard --port<span class=o>=</span><span class=m>52000</span> --url<span class=o>=</span><span class=nb>true</span>
</code></pre></td></tr></table></div></div><h2 id=参考文档>参考文档</h2><ul><li>kubernetes 官方 minikube 介绍： <a href=https://kubernetes.io/zh/docs/tutorials/hello-minikube/>https://kubernetes.io/zh/docs/tutorials/hello-minikube/</a></li><li>kubectl 概述：<a href=https://kubernetes.io/zh/docs/reference/kubectl/>https://kubernetes.io/zh/docs/reference/kubectl/</a></li><li>k8s 辨析 port, NodePort, targetPort, containerPort: <a href=https://www.cnblogs.com/veeupup/p/13545361.html>https://www.cnblogs.com/veeupup/p/13545361.html</a></li><li>k8s 总纲及脑图： <a href=https://sgfoot.com/k8s-mindmap.html>https://sgfoot.com/k8s-mindmap.html</a></li></ul><h2 id=关于作者>关于作者</h2><p>我的博客：https://www.sgfoot.com</p><p>欢迎关注我的微信公众号【空树之空】，共同学习，一起进步~
<img src=https://cdn.jsdelivr.net/gh/yezihack/assets/b/20210122112114.png?imageslim alt=空树之空></p></div><div class=post-copyright><p class=copyright-item><span class=item-title>文章作者</span>
<span class=item-content>百里</span></p><p class=copyright-item><span class=item-title>上次更新</span>
<span class=item-content>2021-12-28</span></p><p class=copyright-item><span class=item-title>许可协议</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></p></div><h1></h1><div class=post-reward><input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>赞赏支持</label><div class=qr-code><label class=qr-code-image for=reward><img class=image src=https://cdn.jsdelivr.net/gh/yezihack/assets/b/20200417142450.jpg?imageslim>
<span>微信打赏</span></label></div></div><footer class=post-footer><div class=post-tags><a href=/tags/k8s.html>k8s</a>
<a href=/tags/%E4%BA%91%E5%8E%9F%E7%94%9F.html>云原生</a>
<a href=/tags/kubernetes.html>kubernetes</a>
<a href=/tags/k8s%E5%AE%89%E8%A3%85.html>k8s安装</a></div><nav class=post-nav><a class=prev href=/harbor-install.html><i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417l277.93508-310.326815c11.338233-12.190647 11.035334-32.285311-.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"/></svg></i><span class="prev-text nav-default">Harbor 安装（TLS）</span>
<span class="prev-text nav-mobile">上一篇</span></a>
<a class=next href=/k8s-mindmap.html><span class="next-text nav-default">Kubernetes 总纲及脑图</span>
<span class="prev-text nav-mobile">下一篇</span>
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"/></svg></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=icon-links><a href=mailto:freeit@126.com rel="me noopener" class=iconfont title=email><svg class="icon" viewBox="0 0 1451 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M664.781909 681.472759.0 97.881301C0 3.997201 71.046997.0 71.046997.0H474.477909 961.649408 1361.641813S1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759S764.482731 685.154773 753.594283 688.65053V688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858V688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759zM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633.0 212.052267.0 212.052267V942.809523L83.726336 1024H682.532949 753.579947 1348.948139L1432.688811 942.809523V212.052267S893.138176 701.759633 817.019477 767.734955C777.248 802.205449 742.347691 811.03081 718.063616 811.603883z"/></svg></a><a href=https://www.github.com/yezihack rel="me noopener" class=iconfont title=github target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M512 12.672c-282.88.0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667.0-12.16-.426667-44.373333-.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333.0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333.0.0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667.0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72.0 68.522667-.64 123.562667-.64 140.202666.0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"/></svg></a><a href=/index.xml rel="noopener alternate" type=application/rss+xml class=iconfont title=rss target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><path d="M819.157333 1024C819.157333 574.592 449.408 204.8.0 204.8V0c561.706667.0 1024 462.293333 1024 1024H819.157333zM140.416 743.04a140.8 140.8.0 01140.501333 140.586667A140.928 140.928.0 01140.074667 1024C62.72 1024 0 961.109333.0 883.626667S62.933333 743.082667 140.416 743.04zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352.0 678.784 306.517333 678.784 678.826667z"/></svg></a></div><div class=copyright><span class=copyright-year>&copy;
2020 -
2022
<span class=heart><i class=iconfont><svg class="icon" viewBox="0 0 1025 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14"><path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7.0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1.0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2.0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3.1-42.5-8-83.6-24-122.2z" fill="#8a8a8a"/></svg></i></span><span class=author><a href=https://www.sgfoot.com>空樹之空</a>
</span><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme - <a class=theme-link href=https://github.com/xianmin/hugo-theme-jane>Jane</a></span></span>
<span id=busuanzi_container>访客数/访问量：<span id=busuanzi_value_site_uv></span>/<span id=busuanzi_value_site_pv></span></span></div></footer><div class=back-to-top id=back-to-top><i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="35" height="35"><path d="M510.866688 227.694839 95.449397 629.218702h235.761562L329.15309 958.01517h362.40389L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777h894.052392v131.813095H63.840492V63.962777zm0 0"/></svg></i></div></div><script type=text/javascript src=/lib/jquery/jquery-3.2.1.min.js></script><script type=text/javascript src=/lib/slideout/slideout-1.0.1.min.js></script><script type=text/javascript src=/js/main.c123da21eb8e940c0619f739a9ba5a0058720dfae9a96bafc91016c54983880f.js integrity="sha256-wSPaIeuOlAwGGfc5qbpaAFhyDfrpqWuvyRAWxUmDiA8=" crossorigin=anonymous></script><script id=baidu_analytics>var _hmt=_hmt||[];(function(){if(window.location.hostname==='localhost')return;var hm=document.createElement("script");hm.async=true;hm.src="https://hm.baidu.com/hm.js?90b270e075265ec9aad9847f47bb1f42";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script><script id=baidu_push>(function(){if(window.location.hostname==='localhost')return;var bp=document.createElement('script');bp.async=true;var curProtocol=window.location.protocol.split(':')[0];if(curProtocol==='https'){bp.src='https://zz.bdstatic.com/linksubmit/push.js';}
else{bp.src='http://push.zhanzhang.baidu.com/push.js';}
var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script><script type=text/javascript src=/js/load-photoswipe.js></script><script type=text/javascript src=/lib/photoswipe/photoswipe.min.js></script><script type=text/javascript src=/lib/photoswipe/photoswipe-ui-default.min.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script></body></html>