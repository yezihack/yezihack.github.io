<!doctype html><html lang=zh-cn itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>MySQL 性能分析 - 空樹之空的博客</title><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=MobileOptimized content="width"><meta name=HandheldFriendly content="true"><meta name=applicable-device content="pc,mobile"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=mobile-web-app-capable content="yes"><meta name=author content="百里"><meta name=description content="MySQL 运行的状态 重点关注以下参数 1 2 3 4 show status like &amp;#39;Queries&amp;#39;; show status like &amp;#39;Threads_connected&amp;#39;; show status like &amp;#39;Threads_running&amp;#39;; show status like &amp;#39;Connection_errors_max_connections&amp;#39;; MySQL 运行线程 1 show processlist 开启慢查询日志 一、参数查询 slow_query_log 开启慢查询 1 2 3 4 5 6 7 8 mysql&amp;gt;"><meta name=keywords content="Go语言,MySQL,Redis,设计模式,读书笔记,人生感悟"><meta name=generator content="Hugo 0.79.1"><link rel=canonical href=/mysql-analysis.html><link rel=icon href=/favicon.ico><link rel=stylesheet href=/sass/jane.min.021cece56b7a73d45503de6c44a7f04dc9247fa4d50d932d81c81d1f76ef1efe.css integrity="sha256-Ahzs5Wt6c9RVA95sRKfwTckkf6TVDZMtgcgdH3bvHv4=" media=screen crossorigin=anonymous><link rel=stylesheet href=/css/toc.css><meta property="og:title" content="MySQL 性能分析"><meta property="og:description" content="MySQL 运行的状态 重点关注以下参数 1 2 3 4 show status like 'Queries'; show status like 'Threads_connected'; show status like 'Threads_running'; show status like 'Connection_errors_max_connections'; MySQL 运行线程 1 show processlist 开启慢查询日志 一、参数查询 slow_query_log 开启慢查询 1 2 3 4 5 6 7 8 mysql>"><meta property="og:type" content="article"><meta property="og:url" content="/mysql-analysis.html"><meta property="article:published_time" content="2020-06-19T19:13:48+08:00"><meta property="article:modified_time" content="2020-06-19T19:13:48+08:00"><meta itemprop=name content="MySQL 性能分析"><meta itemprop=description content="MySQL 运行的状态 重点关注以下参数 1 2 3 4 show status like 'Queries'; show status like 'Threads_connected'; show status like 'Threads_running'; show status like 'Connection_errors_max_connections'; MySQL 运行线程 1 show processlist 开启慢查询日志 一、参数查询 slow_query_log 开启慢查询 1 2 3 4 5 6 7 8 mysql>"><meta itemprop=datePublished content="2020-06-19T19:13:48+08:00"><meta itemprop=dateModified content="2020-06-19T19:13:48+08:00"><meta itemprop=wordCount content="1739"><meta itemprop=keywords content="mysql,性能分析,技巧,工具,"><meta name=twitter:card content="summary"><meta name=twitter:title content="MySQL 性能分析"><meta name=twitter:description content="MySQL 运行的状态 重点关注以下参数 1 2 3 4 show status like 'Queries'; show status like 'Threads_connected'; show status like 'Threads_running'; show status like 'Connection_errors_max_connections'; MySQL 运行线程 1 show processlist 开启慢查询日志 一、参数查询 slow_query_log 开启慢查询 1 2 3 4 5 6 7 8 mysql>"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>空樹之空</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><li class=mobile-menu-item><a class=menu-item-link href=/>首页</a></li><li class=mobile-menu-item><a class=menu-item-link href=/post.html>归档</a></li><li class=mobile-menu-item><a class=menu-item-link href=/tags.html>标签云</a></li><li class=mobile-menu-item><a class=menu-item-link href=/categories.html>分类</a></li><li class=mobile-menu-item><div class=mobile-menu-parent><span class=mobile-submenu-open></span><a href>教程</a></div><ul class=mobile-submenu-list><li><a href=/categories/go%E6%95%99%E7%A8%8B.html>Go 实践教程</a></li><li><a href=/tags/docker%E6%95%99%E7%A8%8B.html>Docker笔记</a></li><li><a href=/tags/elk.html>ELK入门</a></li><li><a href=/tags/prometheus.html>Prometheus</a></li><li><a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html>设计模式</a></li><li><a href=/tags/kubernetes.html>Kubernetes 笔记整理</a></li></ul></li><li class=mobile-menu-item><div class=mobile-menu-parent><span class=mobile-submenu-open></span><a href>自我驱动</a></div><ul class=mobile-submenu-list><li><a href=/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html>读书笔记</a></li><li><a href=/tags/%E5%B7%A5%E7%A8%8B%E5%B8%88.html>工程师</a></li><li><a href=/tags/%E5%88%86%E4%BA%AB.html>价值分享</a></li></ul></li><li class=mobile-menu-item><a class=menu-item-link href=/about.html>地图</a></li></ul></nav><link rel=stylesheet href=/lib/photoswipe/photoswipe.min.css><link rel=stylesheet href=/lib/photoswipe/default-skin/default-skin.min.css><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><style>.fork-me-on-github{position:absolute;top:0;left:0;border:0}@media(max-width:1080px){.fork-me-on-github{display:none}}</style><a href=https://github.com/yezihack><img class=fork-me-on-github src=https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png alt="Fork me on GitHub"></a><header id=header class="header container"><div class=logo-wrapper><a href=/ class=logo>空樹之空</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>首页</a></li><li class=menu-item><a class=menu-item-link href=/post.html>归档</a></li><li class=menu-item><a class=menu-item-link href=/tags.html>标签云</a></li><li class=menu-item><a class=menu-item-link href=/categories.html>分类</a></li><li class=menu-item><a class="menu-item-link menu-parent" href>教程</a><ul class=submenu><li><a href=/categories/go%E6%95%99%E7%A8%8B.html>Go 实践教程</a></li><li><a href=/tags/docker%E6%95%99%E7%A8%8B.html>Docker笔记</a></li><li><a href=/tags/elk.html>ELK入门</a></li><li><a href=/tags/prometheus.html>Prometheus</a></li><li><a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html>设计模式</a></li><li><a href=/tags/kubernetes.html>Kubernetes 笔记整理</a></li></ul></li><li class=menu-item><a class="menu-item-link menu-parent" href>自我驱动</a><ul class=submenu><li><a href=/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html>读书笔记</a></li><li><a href=/tags/%E5%B7%A5%E7%A8%8B%E5%B8%88.html>工程师</a></li><li><a href=/tags/%E5%88%86%E4%BA%AB.html>价值分享</a></li></ul></li><li class=menu-item><a class=menu-item-link href=/about.html>地图</a></li></ul></nav></header><div id=mobile-panel><main id=main class="main bg-llight"><div class=content-wrapper><div id=content class="content container"><article class="post bg-white"><header class=post-header><h1 class=post-title>MySQL 性能分析</h1><div class=post-meta><time datetime=2020-06-19 class=post-time>2020-06-19</time><div class=post-category><a href=/categories/mysql.html>mysql</a></div><span class=more-meta>约 1739 字</span>
<span class=more-meta>预计阅读 4 分钟</span>
<span id=busuanzi_container_page_pv>| 阅读 <span id=busuanzi_value_page_pv></span></span></div></header><div id=post-toc><aside><header><h3>MySQL 性能分析</h3></header><nav id=TableOfContents><ul><li><a href=#mysql-运行的状态>MySQL 运行的状态</a></li><li><a href=#mysql-运行线程>MySQL 运行线程</a></li><li><a href=#开启慢查询日志>开启慢查询日志</a></li><li><a href=#mysqldumpslow-分析慢日志>mysqldumpslow 分析慢日志</a></li><li><a href=#percona-toolkit--分析慢日志>percona-toolkit 分析慢日志</a></li><li><a href=#mysqlslap-基准压测>mysqlslap 基准压测</a></li><li><a href=#参考>参考</a></li></ul></nav></aside><a href=# id=toc-toggle></a></div><div class=post-content><h2 id=mysql-运行的状态>MySQL 运行的状态</h2><p>重点关注以下参数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>show status like &#39;Queries&#39;;
show status like &#39;Threads_connected&#39;;
show status like &#39;Threads_running&#39;;
show status like &#39;Connection_errors_max_connections&#39;;
</code></pre></td></tr></table></div></div><h2 id=mysql-运行线程>MySQL 运行线程</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>show processlist
</code></pre></td></tr></table></div></div><h2 id=开启慢查询日志>开启慢查询日志</h2><p><strong>一、参数查询</strong></p><ol><li><p>slow_query_log 开启慢查询</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>mysql&gt; show variables like <span class=s1>&#39;%slow_query_log%&#39;</span><span class=p>;</span>
+---------------------+--------------------------------------+
<span class=p>|</span> Variable_name       <span class=p>|</span> Value                                <span class=p>|</span>
+---------------------+--------------------------------------+
<span class=p>|</span> slow_query_log      <span class=p>|</span> ON                                   <span class=p>|</span>
<span class=p>|</span> slow_query_log_file <span class=p>|</span> /var/lib/mysql/7709d56792f9-slow.log <span class=p>|</span>
+---------------------+--------------------------------------+
<span class=m>2</span> rows in <span class=nb>set</span> <span class=o>(</span>0.00 sec<span class=o>)</span>
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh><span class=nb>set</span> global <span class=nv>slow_query_log</span><span class=o>=</span>1<span class=p>;</span>
</code></pre></td></tr></table></div></div></li><li><p>slow_query_log_file 慢日志存放位置</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh><span class=nb>set</span> global <span class=nv>slow_query_log_file</span><span class=o>=</span><span class=s1>&#39;/data/logs/slow-mysql.log&#39;</span><span class=p>;</span>
</code></pre></td></tr></table></div></div></li><li><p>long_query_time 表示1秒的SQL就记录</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>mysql&gt; show variables like <span class=s1>&#39;long_query_time&#39;</span><span class=p>;</span>
+-----------------+-----------+
<span class=p>|</span> Variable_name   <span class=p>|</span> Value     <span class=p>|</span>
+-----------------+-----------+
<span class=p>|</span> long_query_time <span class=p>|</span> 10.000000 <span class=p>|</span>
+-----------------+-----------+
<span class=m>1</span> row in <span class=nb>set</span> <span class=o>(</span>0.00 sec<span class=o>)</span>
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>mysql&gt; <span class=nb>set</span> global <span class=nv>long_query_time</span><span class=o>=</span>1<span class=p>;</span>
Query OK, <span class=m>0</span> rows affected <span class=o>(</span>0.00 sec<span class=o>)</span>
   
mysql&gt; show global variables like <span class=s1>&#39;long_query_time&#39;</span><span class=p>;</span>
+-----------------+----------+
<span class=p>|</span> Variable_name   <span class=p>|</span> Value    <span class=p>|</span>
+-----------------+----------+
<span class=p>|</span> long_query_time <span class=p>|</span> 1.000000 <span class=p>|</span>
+-----------------+----------+
<span class=m>1</span> row in <span class=nb>set</span> <span class=o>(</span>0.00 sec<span class=o>)</span>
</code></pre></td></tr></table></div></div></li><li><p>log_output 输出方式</p><blockquote><p>开启慢查询日志后，还要设定log_output变量决定将慢查询日志写到表中还是文件中。log_output由三种值TABLE、FILE和NONE，对应着表、文件和啥都不写。</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>mysql&gt; show variables like <span class=s1>&#39;%log_output%&#39;</span><span class=p>;</span>
+---------------+-------+
<span class=p>|</span> Variable_name <span class=p>|</span> Value <span class=p>|</span>
+---------------+-------+
<span class=p>|</span> log_output    <span class=p>|</span> FILE  <span class=p>|</span>
+---------------+-------+
<span class=m>1</span> row in <span class=nb>set</span> <span class=o>(</span>0.00 sec<span class=o>)</span>
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>mysql&gt; <span class=nb>set</span> global <span class=nv>log_output</span><span class=o>=</span><span class=s1>&#39;TABLE,FILE&#39;</span><span class=p>;</span>
Query OK, <span class=m>0</span> rows affected <span class=o>(</span>0.00 sec<span class=o>)</span>
   
mysql&gt; show variables like <span class=s1>&#39;%log_output%&#39;</span><span class=p>;</span>
+---------------+------------+
<span class=p>|</span> Variable_name <span class=p>|</span> Value      <span class=p>|</span>
+---------------+------------+
<span class=p>|</span> log_output    <span class=p>|</span> FILE,TABLE <span class=p>|</span>
+---------------+------------+
<span class=m>1</span> row in <span class=nb>set</span> <span class=o>(</span>0.01 sec<span class=o>)</span>
</code></pre></td></tr></table></div></div></li><li><p>log_queries_not_using_indexes 记录没有使用索引的SQL语句</p><blockquote><p>log_queries_not_using_indexes：动态可修改变量，默认值OFF。如果设为ON，那么不使用索引的SQL会被记录到慢查询日志中。开启后，慢查询日志可能会增长的很快，可以设定 log_throttle_queries_not_using_indexes 变量来限制，其默认值是0，也就是不限制。如果值大于0，如log_throttle_queries_not_using_indexes=100，则每秒钟记录100条不使用索引的SQL语句到慢查询日志。</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>mysql&gt; show variables like <span class=s1>&#39;log_queries_not_using_indexes&#39;</span><span class=p>;</span>
+-------------------------------+-------+
<span class=p>|</span> Variable_name                 <span class=p>|</span> Value <span class=p>|</span>
+-------------------------------+-------+
<span class=p>|</span> log_queries_not_using_indexes <span class=p>|</span> ON    <span class=p>|</span>
+-------------------------------+-------+
<span class=m>1</span> row in <span class=nb>set</span> <span class=o>(</span>0.00 sec<span class=o>)</span>
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh><span class=nb>set</span> global <span class=nv>log_queries_not_using_indexes</span><span class=o>=</span>1<span class=p>;</span>
</code></pre></td></tr></table></div></div></li><li><p>slow_queries 查询多少条慢日志</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>mysql&gt; show global status like <span class=s1>&#39;%Slow_queries%&#39;</span><span class=p>;</span>
+---------------+-------+
<span class=p>|</span> Variable_name <span class=p>|</span> Value <span class=p>|</span>
+---------------+-------+
<span class=p>|</span> Slow_queries  <span class=p>|</span> <span class=m>0</span>     <span class=p>|</span>
+---------------+-------+
<span class=m>1</span> row in <span class=nb>set</span> <span class=o>(</span>0.03 sec<span class=o>)</span>
</code></pre></td></tr></table></div></div></li><li><p>查看所有的参数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>mysql&gt; show variables like <span class=s1>&#39;%quer%&#39;</span><span class=p>;</span>
+----------------------------------------+---------------------------+
<span class=p>|</span> Variable_name                          <span class=p>|</span> Value                     <span class=p>|</span>
+----------------------------------------+---------------------------+
<span class=p>|</span> binlog_rows_query_log_events           <span class=p>|</span> OFF                       <span class=p>|</span>
<span class=p>|</span> ft_query_expansion_limit               <span class=p>|</span> <span class=m>20</span>                        <span class=p>|</span>
<span class=p>|</span> have_query_cache                       <span class=p>|</span> NO                        <span class=p>|</span>
<span class=p>|</span> log_queries_not_using_indexes          <span class=p>|</span> ON                        <span class=p>|</span>
<span class=p>|</span> log_throttle_queries_not_using_indexes <span class=p>|</span> <span class=m>0</span>                         <span class=p>|</span>
<span class=p>|</span> long_query_time                        <span class=p>|</span> 1.000000                  <span class=p>|</span>
<span class=p>|</span> query_alloc_block_size                 <span class=p>|</span> <span class=m>8192</span>                      <span class=p>|</span>
<span class=p>|</span> query_prealloc_size                    <span class=p>|</span> <span class=m>8192</span>                      <span class=p>|</span>
<span class=p>|</span> slow_query_log                         <span class=p>|</span> OFF                       <span class=p>|</span>
<span class=p>|</span> slow_query_log_file                    <span class=p>|</span> /data/logs/slow-mysql.log <span class=p>|</span>
+----------------------------------------+---------------------------+
<span class=m>10</span> rows in <span class=nb>set</span> <span class=o>(</span>0.00 sec<span class=o>)</span>
</code></pre></td></tr></table></div></div></li></ol><p>以上命令行下操作只是当前连接有效，其它无效。需要生效则需要写入配置文件<code>my.cnf</code></p><p><strong>二、修改配置文件</strong></p><p>在配置文件 my.cnf 中的 [mysqld] 添加以下参数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>[mysqld]
log_output=file
slow_query_log=1
slow_query_log_file = /data/logs/slow-mysql.log
log_queries_not_using_indexes=1
long_query_time = 1
</code></pre></td></tr></table></div></div><p><strong>三、配置完后重启MySQL</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback># 系统安装
systemctl restart mysqld
# 如果是 docker 
docker restart containerID
</code></pre></td></tr></table></div></div><h2 id=mysqldumpslow-分析慢日志>mysqldumpslow 分析慢日志</h2><ol><li>-s：排序方式，后边接着如下参数
c：访问次数
l：锁定时间
r：返回记录
t：查询时间</li><li>al：平均锁定时间</li><li>ar：平均返回记录书</li><li>at：平均查询时间</li><li>-t：返回前面多少条的数据</li><li>-g：翻遍搭配一个正则表达式，大小写不敏感</li></ol><p>得到返回记录集最多的10个SQL。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>mysqldumpslow -s r -t <span class=m>10</span> /data/logs/slow-mysql.log
</code></pre></td></tr></table></div></div><p>得到访问次数最多的10个SQL</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>mysqldumpslow -s c -t <span class=m>10</span> /data/logs/slow-mysql.log
</code></pre></td></tr></table></div></div><p>得到按照时间排序的前10条里面含有左连接的查询语句。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>mysqldumpslow -s t -t <span class=m>10</span> -g “left join” /data/logs/slow-mysql.log
</code></pre></td></tr></table></div></div><p>另外建议在使用这些命令时结合 | 和more 使用 ，否则有可能出现刷屏的情况。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>mysqldumpslow -s r -t <span class=m>20</span> /data/logs/slow-mysql.log <span class=p>|</span> more
</code></pre></td></tr></table></div></div><h2 id=percona-toolkit--分析慢日志>percona-toolkit 分析慢日志</h2><ol><li><p>下载</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>wget https://www.percona.com/downloads/percona-toolkit/3.2.1/binary/redhat/7/x86_64/percona-toolkit-3.2.1-1.el7.x86_64.rpm
</code></pre></td></tr></table></div></div></li><li><p>依赖包</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh><span class=o>[</span>root@xxx ~<span class=o>]</span><span class=c1># yum install perl-DBI.x86_64</span>
<span class=o>[</span>root@xxx ~<span class=o>]</span><span class=c1># yum install perl-DBD-MySQL.x86_64</span>
<span class=o>[</span>root@xxx ~<span class=o>]</span><span class=c1># yum install perl-IO-Socket-SSL.noarch</span>
<span class=o>[</span>root@xxx ~<span class=o>]</span><span class=c1># yum install perl-Digest-MD5.x86_64</span>
<span class=o>[</span>root@xxx ~<span class=o>]</span><span class=c1># yum install perl-TermReadKey.x86_64</span>
</code></pre></td></tr></table></div></div></li><li><p>安装</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>rpm -iv percona-toolkit-3.2.1-1.el7.x86_64.rpm
</code></pre></td></tr></table></div></div></li><li><p>位置</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>whereis pt-query-digest
</code></pre></td></tr></table></div></div></li><li><p>分析慢日志</p><blockquote><p>回看上面如何开启慢日志</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>pt-query-digest mysql-slow.log
</code></pre></td></tr></table></div></div></li></ol><h2 id=mysqlslap-基准压测>mysqlslap 基准压测</h2><p><strong>参考说明：</strong></p><ol><li><code>--concurrency</code> 并发数,可指定多个值，以逗号</li><li><code>--iterations</code> 运行次数</li><li><code>--auto-generate-sql</code> 自动生成测试表和数据</li><li><code>--auto-generate-sql-load-type</code> 测试语句的类型,read，key，write，update和mixed(默认)。</li><li><code>--auto-generate-sql-add-auto-increment</code> 代表对生成的表自动添加auto_increment列，从5.1.18版本开始支持。</li><li><code>--engine=engine_name</code> 代表要测试的引擎，可以有多个，用分隔符隔开。例如：&ndash;engines=myisam,innodb。</li><li><code>--number-of-queries</code> 总的测试查询次数(并发客户数×每客户查询次数)</li><li><code>--query 自己的SQL</code>　　　　　　　　 脚本执行测试</li><li><code>--only-print</code> 　　　　　　　　　　 如果只想打印看看SQL语句是什么，可以用这个选项</li></ol><p><strong>运行命令</strong></p><ol><li><p>测试单SQL</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-mysql data-lang=mysql><span class=n>mysqlslap</span> <span class=o>-</span><span class=n>a</span> <span class=o>-</span><span class=n>uroot</span> <span class=o>-</span><span class=n>p123456</span>
</code></pre></td></tr></table></div></div></li><li><p>测试多并发</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-mysql data-lang=mysql><span class=n>mysqlslap</span> <span class=o>-</span><span class=n>a</span> <span class=o>-</span><span class=n>c</span> <span class=mi>100</span> <span class=o>-</span><span class=n>uroot</span> <span class=o>-</span><span class=n>p123456</span> <span class=o>-</span><span class=n>h</span> <span class=mi>127</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>1</span>
</code></pre></td></tr></table></div></div></li><li><p>模拟不同并发，并打印错误信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-mysql data-lang=mysql><span class=c1># 执行一次测试，分别50和100个并发，执行1000次总查询：
</span><span class=c1></span><span class=n>mysqlslap</span> <span class=o>-</span><span class=n>a</span> <span class=o>--</span><span class=n>concurrency</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span><span class=mi>100</span> <span class=o>--</span><span class=n>number</span><span class=o>-</span><span class=n>of</span><span class=o>-</span><span class=n>queries</span> <span class=mi>1000</span> <span class=o>--</span><span class=n>debug</span><span class=o>-</span><span class=n>info</span> <span class=o>-</span><span class=n>uroot</span> <span class=o>-</span><span class=n>p12345</span>
</code></pre></td></tr></table></div></div></li><li><p>更复杂的测试</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-mysql data-lang=mysql><span class=n>mysqlslap</span> <span class=o>-</span><span class=n>h</span> <span class=mi>127</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>1</span> <span class=o>-</span><span class=n>u</span> <span class=n>root</span> <span class=o>-</span><span class=n>p123456</span> <span class=o>--</span><span class=n>concurrency</span><span class=o>=</span><span class=mi>100</span> <span class=o>--</span><span class=n>iterations</span><span class=o>=</span><span class=mi>1</span> <span class=o>--</span><span class=n>auto</span><span class=o>-</span><span class=n>generate</span><span class=o>-</span><span class=k>sql</span> <span class=o>--</span><span class=n>auto</span><span class=o>-</span><span class=n>generate</span><span class=o>-</span><span class=k>sql</span><span class=o>-</span><span class=k>load</span><span class=o>-</span><span class=n>type</span><span class=o>=</span><span class=n>mixed</span> <span class=o>--</span><span class=n>auto</span><span class=o>-</span><span class=n>generate</span><span class=o>-</span><span class=k>sql</span><span class=o>-</span><span class=k>add</span><span class=o>-</span><span class=n>autoincrement</span> <span class=o>--</span><span class=kp>engine</span><span class=o>=</span><span class=n>innodb</span> <span class=o>--</span><span class=n>number</span><span class=o>-</span><span class=n>of</span><span class=o>-</span><span class=n>queries</span><span class=o>=</span><span class=mi>5000</span>
<span class=c1># -p密码 密码与p没有空格
</span></code></pre></td></tr></table></div></div></li><li><p>查看SQL</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-mysql data-lang=mysql><span class=n>mysqlslap</span> <span class=o>-</span><span class=n>a</span> <span class=o>--</span><span class=n>concurrency</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span><span class=mi>100</span> <span class=o>--</span><span class=n>number</span><span class=o>-</span><span class=n>of</span><span class=o>-</span><span class=n>queries</span> <span class=mi>1000</span> <span class=o>--</span><span class=n>iterations</span><span class=o>=</span><span class=mi>5</span> <span class=o>--</span><span class=n>debug</span><span class=o>-</span><span class=n>info</span> <span class=o>-</span><span class=n>uroot</span> <span class=o>-</span><span class=n>p123456</span> <span class=o>-</span><span class=n>h</span> <span class=mi>127</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>1</span> <span class=o>--</span><span class=n>only</span><span class=o>-</span><span class=n>print</span>
</code></pre></td></tr></table></div></div></li></ol><p><strong>结果分析：</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>Benchmark
	Average number of seconds to run all queries: 0.160 seconds  # 平均响应时间
	Minimum number of seconds to run all queries: 0.156 seconds	 # 最小响应时间
	Maximum number of seconds to run all queries: 0.166 seconds  # 最大响应时间
	Number of clients running queries: 50 	 # 模拟客户端数量
	Average number of queries per client: 20 # 每个客户端的平均查询SQL条数



User time 0.24, System time 0.37 # 用户响应时间，系统响应时间
Maximum resident set size 14568, Integral resident set size 0
Non-physical pagefaults 8068, Physical pagefaults 0, Swaps 0
Blocks in 0 out 0, Messages in 0 out 0, Signals 0
Voluntary context switches 19587, Involuntary context switches 723
</code></pre></td></tr></table></div></div><h2 id=参考>参考</h2><ol><li><a href=https://juejin.im/post/59d83f1651882545eb54fc7e>https://juejin.im/post/59d83f1651882545eb54fc7e</a></li><li><a href=https://coolshell.cn/articles/1846.html>https://coolshell.cn/articles/1846.html</a></li><li><a href=https://www.cnblogs.com/kerrycode/p/5593204.html>MySQL慢查询日志总结</a></li></ol></div><div class=post-copyright><p class=copyright-item><span class=item-title>文章作者</span>
<span class=item-content>百里</span></p><p class=copyright-item><span class=item-title>上次更新</span>
<span class=item-content>2020-06-19</span></p><p class=copyright-item><span class=item-title>许可协议</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></p></div><h1></h1><div class=post-reward><input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>赞赏支持</label><div class=qr-code><label class=qr-code-image for=reward><img class=image src=https://cdn.jsdelivr.net/gh/yezihack/assets/b/20200417142450.jpg?imageslim>
<span>微信打赏</span></label></div></div><footer class=post-footer><div class=post-tags><a href=/tags/mysql.html>mysql</a>
<a href=/tags/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90.html>性能分析</a>
<a href=/tags/%E6%8A%80%E5%B7%A7.html>技巧</a>
<a href=/tags/%E5%B7%A5%E5%85%B7.html>工具</a></div><nav class=post-nav><a class=prev href=/mysql-optimize.html><i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417l277.93508-310.326815c11.338233-12.190647 11.035334-32.285311-.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"/></svg></i><span class="prev-text nav-default">MySQL 性能优化</span>
<span class="prev-text nav-mobile">上一篇</span></a>
<a class=next href=/systemctl.html><span class="next-text nav-default">Systemctl使用与自定义</span>
<span class="prev-text nav-mobile">下一篇</span>
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"/></svg></i></a></nav></footer></article></div></div></main><footer id=footer class=footer><div class=icon-links><a href=mailto:freeit@126.com rel="me noopener" class=iconfont title=email><svg class="icon" viewBox="0 0 1451 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M664.781909 681.472759.0 97.881301C0 3.997201 71.046997.0 71.046997.0H474.477909 961.649408 1361.641813S1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759S764.482731 685.154773 753.594283 688.65053V688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858V688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759zM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633.0 212.052267.0 212.052267V942.809523L83.726336 1024H682.532949 753.579947 1348.948139L1432.688811 942.809523V212.052267S893.138176 701.759633 817.019477 767.734955C777.248 802.205449 742.347691 811.03081 718.063616 811.603883z"/></svg></a><a href=https://www.github.com/yezihack rel="me noopener" class=iconfont title=github target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M512 12.672c-282.88.0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667.0-12.16-.426667-44.373333-.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333.0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333.0.0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667.0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72.0 68.522667-.64 123.562667-.64 140.202666.0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"/></svg></a><a href=/index.xml rel="noopener alternate" type=application/rss+xml class=iconfont title=rss target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><path d="M819.157333 1024C819.157333 574.592 449.408 204.8.0 204.8V0c561.706667.0 1024 462.293333 1024 1024H819.157333zM140.416 743.04a140.8 140.8.0 01140.501333 140.586667A140.928 140.928.0 01140.074667 1024C62.72 1024 0 961.109333.0 883.626667S62.933333 743.082667 140.416 743.04zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352.0 678.784 306.517333 678.784 678.826667z"/></svg></a></div><div class=copyright><span class=copyright-year>&copy;
2020 -
2022
<span class=heart><i class=iconfont><svg class="icon" viewBox="0 0 1025 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14"><path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7.0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1.0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2.0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3.1-42.5-8-83.6-24-122.2z" fill="#8a8a8a"/></svg></i></span><span class=author><a href=https://www.sgfoot.com>空樹之空</a>
</span><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme - <a class=theme-link href=https://github.com/xianmin/hugo-theme-jane>Jane</a></span></span>
<span id=busuanzi_container>访客数/访问量：<span id=busuanzi_value_site_uv></span>/<span id=busuanzi_value_site_pv></span></span></div></footer><div class=back-to-top id=back-to-top><i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="35" height="35"><path d="M510.866688 227.694839 95.449397 629.218702h235.761562L329.15309 958.01517h362.40389L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777h894.052392v131.813095H63.840492V63.962777zm0 0"/></svg></i></div></div><script type=text/javascript src=/lib/jquery/jquery-3.2.1.min.js></script><script type=text/javascript src=/lib/slideout/slideout-1.0.1.min.js></script><script type=text/javascript src=/js/main.c123da21eb8e940c0619f739a9ba5a0058720dfae9a96bafc91016c54983880f.js integrity="sha256-wSPaIeuOlAwGGfc5qbpaAFhyDfrpqWuvyRAWxUmDiA8=" crossorigin=anonymous></script><script id=baidu_analytics>var _hmt=_hmt||[];(function(){if(window.location.hostname==='localhost')return;var hm=document.createElement("script");hm.async=true;hm.src="https://hm.baidu.com/hm.js?90b270e075265ec9aad9847f47bb1f42";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script><script id=baidu_push>(function(){if(window.location.hostname==='localhost')return;var bp=document.createElement('script');bp.async=true;var curProtocol=window.location.protocol.split(':')[0];if(curProtocol==='https'){bp.src='https://zz.bdstatic.com/linksubmit/push.js';}
else{bp.src='http://push.zhanzhang.baidu.com/push.js';}
var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script><script type=text/javascript src=/js/load-photoswipe.js></script><script type=text/javascript src=/lib/photoswipe/photoswipe.min.js></script><script type=text/javascript src=/lib/photoswipe/photoswipe-ui-default.min.js></script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script></body></html>